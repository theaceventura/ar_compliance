{% extends "base.html" %}

{% block content %}
<h2 class="text-xl font-semibold mb-4">App Config</h2>

<div class="bg-white shadow rounded max-w-xl relative" data-widget-id="admin-app-config">
    <div class="bg-slate-100 px-3 py-2 rounded-t font-semibold text-slate-700">Settings</div>
    <form method="POST" class="p-4 space-y-2">
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">App name</div>
            <div class="text-center">
                <input name="app_name" value="{{ settings.app_name }}" class="w-full border p-2 rounded text-sm" placeholder="Compliance Tracker">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Version number</div>
            <div class="text-center">
                <input name="version" value="{{ settings.version }}" class="w-full border p-2 rounded text-sm" placeholder="e.g. 1.0">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-100/60 text-sm">
            <div class="text-left">Show version number on each page</div>
            <div class="text-center">
                <input type="checkbox" name="show_version" {% if settings.show_version %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Show page name on each page</div>
            <div class="text-center">
                <input type="checkbox" name="show_page_name" {% if settings.show_page_name %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-100/60 text-sm">
            <div class="text-left">Show module tree on each page</div>
            <div class="text-center">
                <input type="checkbox" name="show_module_tree" {% if settings.show_module_tree %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Show widget reference buttons</div>
            <div class="text-center">
                <input type="checkbox" name="show_cut_icon" {% if settings.show_cut_icon %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-100/60 text-sm">
            <div class="text-left">Show label edit buttons</div>
            <div class="text-center">
                <input type="checkbox" name="show_label_edit" {% if settings.show_label_edit %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Show validation notes on setup screens</div>
            <div class="text-center">
                <input type="checkbox" name="show_validation_notes" {% if settings.show_validation_notes %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Show logged-in user/role banner</div>
            <div class="text-center">
                <input type="checkbox" name="show_user_banner" {% if settings.show_user_banner %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="flex items-center justify-end gap-2 pt-2 px-3">
            <button class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
        </div>
    </form>
</div>

<div class="bg-white shadow rounded max-w-xl mt-6 relative" data-widget-id="app-config-chart-colors">
    <div class="bg-slate-100 px-3 py-2 rounded-t font-semibold text-slate-700">Chart Colors</div>
    {% set comp_completed = completion_colors.get('Completed', '#16a34a') %}
    {% set comp_pending = completion_colors.get('Pending', '#f59e0b') %}
    {% set comp_overdue = completion_colors.get('Overdue', '#ef4444') %}
    <form method="POST" action="/admin/task-config/colors" class="p-4 space-y-2 text-sm">
        <div class="grid grid-cols-[1fr,150px,130px] items-center bg-slate-100 px-3 py-2 rounded font-semibold text-slate-700">
            <div class="text-left">Label</div>
            <div class="text-center">Colour</div>
            <div class="text-center">Hex</div>
        </div>
        {% for label, val, bg in [
            ('Completed', comp_completed, 'bg-slate-50'),
            ('Pending', comp_pending, 'bg-slate-100/60'),
            ('Overdue', comp_overdue, 'bg-slate-50')
        ] %}
        <div class="grid grid-cols-[1fr,150px,130px] items-center px-3 py-2 rounded {{ bg }}">
            <div class="text-left">{{ label }}</div>
            <input type="color" name="completion_{{ label|lower }}" value="{{ val }}" class="h-9 w-16 border rounded mx-auto">
            <input type="text" value="{{ val }}" readonly class="text-xs text-slate-600 bg-slate-50 border rounded px-2 py-1 text-center">
        </div>
        {% endfor %}
        <div class="flex items-center justify-end gap-2 pt-2 px-3">
            <button class="bg-blue-600 text-white px-4 py-2 rounded">Save Chart Colors</button>
        </div>
    </form>
</div>

<div class="bg-white shadow rounded max-w-xl mt-6 relative" data-widget-id="app-config-display-options">
    <div class="bg-slate-100 px-3 py-2 rounded-t font-semibold text-slate-700">Admin Task Display Options</div>
    <form method="POST" class="p-4 space-y-2 text-sm">
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">Show Task Risk Charts</div>
            <div class="text-center">
                <input type="checkbox" name="show_task_charts" {% if settings.show_task_charts %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-100/60 text-sm">
            <div class="text-left">Show Task Risk Matrix</div>
            <div class="text-center">
                <input type="checkbox" name="show_risk_matrix" {% if settings.show_risk_matrix %}checked{% endif %} class="h-4 w-4">
            </div>
        </div>
        <div class="grid grid-cols-[1fr,180px] items-center px-3 py-2 rounded bg-slate-50 text-sm">
            <div class="text-left">User Dashboard Charts (per role)</div>
            <div class="text-center space-y-1">
                <label class="flex items-center justify-start gap-2 text-xs text-slate-700">
                    <input type="checkbox" name="show_user_charts_global" {% if settings.show_user_charts_global %}checked{% endif %} class="h-4 w-4">
                    <span>Admin</span>
                </label>
                <label class="flex items-center justify-start gap-2 text-xs text-slate-700">
                    <input type="checkbox" name="show_user_charts_company" {% if settings.show_user_charts_company %}checked{% endif %} class="h-4 w-4">
                    <span>Admin</span>
                </label>
                <label class="flex items-center justify-start gap-2 text-xs text-slate-700">
                    <input type="checkbox" name="show_user_charts_user" {% if settings.show_user_charts_user %}checked{% endif %} class="h-4 w-4">
                    <span>User</span>
                </label>
            </div>
        </div>
        <div class="flex items-center justify-end gap-2 pt-2 px-3">
            <button class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
        </div>
    </form>
</div>

{% endblock %}
